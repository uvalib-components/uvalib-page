<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../uvalib-analytics/uvalib-analytics.html">
<link rel="import" href="../uvalib-header/uvalib-header.html">
<link rel="import" href="../uvalib-logos/uvalib-logo.html">
<link rel="import" href="../uvalib-nav/uvalib-nav.html">
<link rel="import" href="../uvalib-footer/uvalib-footer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../iron-media-query/iron-media-query.html">
<link rel="import" href="../uvalib-theme/uvalib-common-styles.html">
<link rel="import" href="../app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../iron-signals/iron-signals.html">

<!--
`uvalib-page`
Library Web Page template

@demo demo/index.html
-->

<dom-module id="uvalib-page">
  <template>
    <style is="custom-style" include="uvalib-theme">
      :host {
        display: block;
      }

      uvalib-header {
        z-index: 1000
      }
      app-toolbar {
        width: 256px;
        height: 110px;
        padding: 20px 0px 0px 0px;

        background-color: var(--color-primary-blue);
      }
      uvalib-logo {
        width: 235px;
        height: 110px;
        margin: 10px;
      }
      app-drawer {
        z-index: 1500
      }
    </style>

    <iron-media-query query="(max-width: 600px)" query-matches="{{_smallScreen}}"></iron-media-query>
    <iron-media-query query="(min-width: 600px) and (max-width: 992px)" query-matches="{{_mediumScreen}}"></iron-media-query>

    <uvalib-header screen-size="{{screenSize}}" navigation="{{navigation}}" on-open-drawer="_toggleDrawer" content-has-no-search-box="{{contentHasNoSearchBox}}"></uvalib-header>

    <!-- Lazy-create the drawer for small screen sizes. -->
      <!-- Two-way bind `drawerOpened` since app-drawer can update `opened` itself. -->
      <app-drawer id="sidenav" swipe-open tabindex="0">
        <app-toolbar>
          <uvalib-logo stacked reverse two-color></uvalib-logo>
        </app-toolbar>
        <uvalib-nav stacked navigation="{{mobileNavigation}}"></uvalib-nav>
      </app-drawer>

    <div class="content"><content></content></div>

    <uvalib-footer></uvalib-footer>

    <!-- Library Site Analytics -->
    <uvalib-analytics site-id="10"></uvalib-analytics>
  </template>

  <script>
    Polymer({

      is: 'uvalib-page',

      properties: {
        /**
         * Array of JSON items that represent the navigation. Each JSON item has a label property, an icon property, and a url property.
         */
        navigation: {
          type: Array,
          value: [
            {"label": "About", "icon": "university", "url": "/about-uva-library/"},
            {"label": "Research", "icon": "graduation-cap", "url": "/research/"},
            {"label": "Collections", "icon": "book", "url": "/collections/"},
            {"label": "Services", "icon": "cloud", "url": "/services/"}
          ],
        },
        mobileNavigation: {
          type: Array,
          value: [
            {"label": "About", "icon": "university", "url": "/about-uva-library/"},
            {"label": "Research", "icon": "graduation-cap", "url": "/research/"},
            {"label": "Collections", "icon": "book", "url": "/collections/"},
            {"label": "Services", "icon": "cloud", "url": "/services/"},
            {"label": "Ask A Librarian", "icon": "comments", "url": "/askalibrarian/"}
          ],
        },
        contentHasNoSearchBox: {
          type: Boolean,
          value: false
        },
        _smallScreen: {
          type: Boolean,
          notify: true,
          value: false,
          reflectToAttribute: true
        },
        _mediumScreen: Boolean,
        screenSize: {
          type: String,
          value: 'large',
          notify: true,
          readOnly: true
        },
      },
      observers: [
        '_updateScreenSize(_smallScreen,_mediumScreen)',
        '_searchInViewChange(contentHasNoSearchBox)'
      ],
      _searchInViewChange: function(inView) {
        if (screenSize == 'large') {
          this.fire('iron-signal', {name: "searchinview", data: inView});
        }
      },
      _toggleDrawer: function() {
        this.$.sidenav.toggle();
      },
      _updateScreenSize: function() {
        this._setScreenSize(
          (this._smallScreen)?'small':
                              (this._mediumScreen)?'medium':
                                                   'large'
        );
      }
    });
  </script>
</dom-module>
